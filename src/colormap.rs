#![deny(missing_docs)]

//! Defines functions to map scalar values to RGB color codes.
//!
//! This module converts a [`f64`] value to a set of three [`u8`] values representing `RGB` value.

/// Seismic-like color map
/// # Arguments
/// * `val` : Normalised value to be converted.
///
/// # Returns
/// A set of `RGB` values based on the seismic color map.
///
/// # Reference
/// [matplotlib/lib/matplotlib/_cm.py](https://github.com/matplotlib/matplotlib).
pub fn seismic(val: f64) -> [u8; 3] {
    fn linear(val: f64, xs: [f64; 2], ys: [f64; 2]) -> f64 {
        return ys[0] + (ys[1] - ys[0]) / (xs[1] - xs[0]) * (val - xs[0]);
    }
    const XLEVELS: [f64; 5] = [0., 1. / 4., 2. / 4., 3. / 4., 4. / 4.];
    const YLEVELS: [f64; 3] = [1. / 4., 3. / 4., 4. / 4.];
    let r: f64 = if val < XLEVELS[1] {
        YLEVELS[0]
    } else if val < XLEVELS[2] {
        linear(val, [XLEVELS[1], XLEVELS[2]], [YLEVELS[0], YLEVELS[2]])
    } else if val < XLEVELS[3] {
        YLEVELS[2]
    } else if val < XLEVELS[4] {
        linear(val, [XLEVELS[3], XLEVELS[4]], [YLEVELS[2], YLEVELS[1]])
    } else {
        YLEVELS[1]
    };
    let g: f64 = if val < XLEVELS[1] {
        YLEVELS[0]
    } else if val < XLEVELS[2] {
        linear(val, [XLEVELS[1], XLEVELS[2]], [YLEVELS[0], YLEVELS[2]])
    } else if val < XLEVELS[3] {
        linear(val, [XLEVELS[2], XLEVELS[3]], [YLEVELS[2], YLEVELS[0]])
    } else {
        YLEVELS[0]
    };
    let b: f64 = if val < XLEVELS[0] {
        YLEVELS[1]
    } else if val < XLEVELS[1] {
        linear(val, [XLEVELS[0], XLEVELS[1]], [YLEVELS[1], YLEVELS[2]])
    } else if val < XLEVELS[2] {
        YLEVELS[2]
    } else if val < XLEVELS[3] {
        linear(val, [XLEVELS[2], XLEVELS[3]], [YLEVELS[2], YLEVELS[0]])
    } else {
        YLEVELS[0]
    };
    return [(255. * r) as u8, (255. * g) as u8, (255. * b) as u8];
}

/// Viridis color map
/// # Arguments
/// * `val` : Normalised value to be converted.
///
/// # Returns
/// A set of `RGB` values based on the viridis color map.
///
/// # Reference
/// [matplotlib/lib/matplotlib/_cm_listed.py](https://github.com/matplotlib/matplotlib).
pub fn viridis(val: f64) -> [u8; 3] {
    const DATA: [[u8; 3]; 256] = [
        [68, 1, 84],
        [69, 2, 86],
        [69, 3, 87],
        [69, 5, 89],
        [70, 6, 90],
        [70, 8, 92],
        [70, 9, 93],
        [70, 11, 95],
        [71, 12, 96],
        [71, 14, 97],
        [71, 15, 99],
        [71, 17, 100],
        [72, 18, 102],
        [72, 20, 103],
        [72, 21, 104],
        [72, 23, 105],
        [72, 24, 107],
        [72, 25, 108],
        [72, 27, 109],
        [72, 28, 110],
        [72, 29, 112],
        [72, 31, 113],
        [72, 32, 114],
        [72, 33, 115],
        [72, 34, 116],
        [72, 36, 117],
        [72, 37, 118],
        [72, 38, 119],
        [72, 40, 120],
        [72, 41, 121],
        [72, 42, 122],
        [71, 43, 123],
        [71, 45, 124],
        [71, 46, 125],
        [71, 47, 125],
        [70, 48, 126],
        [70, 50, 127],
        [70, 51, 128],
        [70, 52, 128],
        [69, 53, 129],
        [69, 55, 130],
        [69, 56, 130],
        [68, 57, 131],
        [68, 58, 132],
        [68, 59, 132],
        [67, 61, 133],
        [67, 62, 133],
        [66, 63, 134],
        [66, 64, 134],
        [66, 65, 135],
        [65, 67, 135],
        [65, 68, 136],
        [64, 69, 136],
        [64, 70, 137],
        [63, 71, 137],
        [63, 72, 137],
        [62, 73, 138],
        [62, 75, 138],
        [61, 76, 138],
        [61, 77, 138],
        [61, 78, 139],
        [60, 79, 139],
        [60, 80, 139],
        [59, 81, 140],
        [59, 82, 140],
        [58, 83, 140],
        [58, 85, 140],
        [57, 86, 140],
        [57, 87, 141],
        [56, 88, 141],
        [56, 89, 141],
        [55, 90, 141],
        [55, 91, 141],
        [54, 92, 141],
        [54, 93, 141],
        [53, 94, 142],
        [53, 95, 142],
        [52, 96, 142],
        [52, 97, 142],
        [51, 98, 142],
        [51, 99, 142],
        [50, 100, 142],
        [50, 101, 142],
        [49, 102, 142],
        [49, 103, 142],
        [48, 104, 142],
        [48, 105, 142],
        [48, 106, 143],
        [47, 107, 143],
        [47, 108, 143],
        [46, 109, 143],
        [46, 110, 143],
        [46, 111, 143],
        [45, 112, 143],
        [45, 113, 143],
        [44, 114, 143],
        [44, 115, 143],
        [43, 116, 143],
        [43, 117, 143],
        [43, 118, 143],
        [42, 119, 143],
        [42, 120, 143],
        [42, 121, 143],
        [41, 122, 143],
        [41, 122, 143],
        [40, 123, 143],
        [40, 124, 143],
        [40, 125, 143],
        [39, 126, 143],
        [39, 127, 143],
        [39, 128, 143],
        [38, 129, 143],
        [38, 130, 143],
        [37, 131, 143],
        [37, 132, 143],
        [37, 133, 143],
        [36, 134, 142],
        [36, 135, 142],
        [36, 136, 142],
        [35, 137, 142],
        [35, 138, 142],
        [35, 139, 142],
        [34, 140, 142],
        [34, 140, 142],
        [34, 141, 142],
        [33, 142, 141],
        [33, 143, 141],
        [33, 144, 141],
        [32, 145, 141],
        [32, 146, 141],
        [32, 147, 141],
        [31, 148, 140],
        [31, 149, 140],
        [31, 150, 140],
        [31, 151, 140],
        [31, 152, 139],
        [30, 153, 139],
        [30, 154, 139],
        [30, 155, 139],
        [30, 156, 138],
        [30, 157, 138],
        [30, 158, 138],
        [30, 158, 137],
        [30, 159, 137],
        [31, 160, 137],
        [31, 161, 136],
        [31, 162, 136],
        [31, 163, 135],
        [32, 164, 135],
        [32, 165, 135],
        [32, 166, 134],
        [33, 167, 134],
        [33, 168, 133],
        [34, 169, 133],
        [35, 170, 132],
        [36, 171, 131],
        [36, 172, 131],
        [37, 172, 130],
        [38, 173, 130],
        [39, 174, 129],
        [40, 175, 128],
        [41, 176, 128],
        [42, 177, 127],
        [43, 178, 126],
        [45, 179, 126],
        [46, 180, 125],
        [47, 181, 124],
        [49, 182, 123],
        [50, 182, 123],
        [51, 183, 122],
        [53, 184, 121],
        [54, 185, 120],
        [56, 186, 119],
        [58, 187, 118],
        [59, 188, 118],
        [61, 189, 117],
        [63, 189, 116],
        [64, 190, 115],
        [66, 191, 114],
        [68, 192, 113],
        [70, 193, 112],
        [72, 194, 111],
        [74, 194, 110],
        [76, 195, 109],
        [78, 196, 107],
        [80, 197, 106],
        [82, 198, 105],
        [84, 198, 104],
        [86, 199, 103],
        [88, 200, 102],
        [90, 201, 100],
        [92, 201, 99],
        [94, 202, 98],
        [97, 203, 97],
        [99, 204, 95],
        [101, 204, 94],
        [103, 205, 93],
        [106, 206, 91],
        [108, 207, 90],
        [110, 207, 89],
        [113, 208, 87],
        [115, 209, 86],
        [117, 209, 84],
        [120, 210, 83],
        [122, 211, 81],
        [125, 211, 80],
        [127, 212, 78],
        [130, 212, 77],
        [132, 213, 75],
        [135, 214, 74],
        [137, 214, 72],
        [140, 215, 70],
        [142, 215, 69],
        [145, 216, 67],
        [147, 217, 65],
        [150, 217, 64],
        [153, 218, 62],
        [155, 218, 60],
        [158, 219, 59],
        [161, 219, 57],
        [163, 220, 55],
        [166, 220, 53],
        [169, 221, 52],
        [171, 221, 50],
        [174, 221, 48],
        [177, 222, 46],
        [179, 222, 45],
        [182, 223, 43],
        [185, 223, 41],
        [187, 224, 40],
        [190, 224, 38],
        [193, 224, 36],
        [195, 225, 35],
        [198, 225, 33],
        [201, 225, 32],
        [203, 226, 30],
        [206, 226, 29],
        [209, 227, 28],
        [212, 227, 27],
        [214, 227, 26],
        [217, 228, 25],
        [219, 228, 25],
        [222, 228, 24],
        [225, 229, 24],
        [227, 229, 24],
        [230, 229, 24],
        [232, 229, 25],
        [235, 230, 25],
        [238, 230, 26],
        [240, 230, 27],
        [243, 231, 28],
        [245, 231, 30],
        [247, 231, 31],
        [250, 232, 33],
        [252, 232, 35],
        [255, 232, 36],
    ];
    let index: usize = (255. * val) as usize;
    return DATA[index];
}

/// Inferno color map
/// # Arguments
/// * `val` : Normalised value to be converted.
///
/// # Returns
/// A set of `RGB` values based on the inferno color map.
///
/// # Reference
/// [matplotlib/lib/matplotlib/_cm_listed.py](https://github.com/matplotlib/matplotlib).
pub fn inferno(val: f64) -> [u8; 3] {
    const DATA: [[u8; 3]; 256] = [
        [0, 0, 3],
        [0, 0, 4],
        [0, 0, 6],
        [1, 0, 7],
        [1, 1, 9],
        [1, 1, 11],
        [2, 1, 14],
        [2, 2, 16],
        [3, 2, 18],
        [4, 3, 20],
        [4, 3, 22],
        [5, 4, 24],
        [6, 4, 27],
        [7, 5, 29],
        [8, 6, 31],
        [9, 6, 33],
        [10, 7, 36],
        [12, 7, 38],
        [13, 8, 40],
        [14, 8, 43],
        [15, 9, 45],
        [16, 9, 47],
        [18, 10, 50],
        [19, 10, 52],
        [20, 11, 55],
        [22, 11, 57],
        [23, 11, 59],
        [25, 11, 62],
        [26, 12, 64],
        [28, 12, 67],
        [29, 12, 69],
        [31, 12, 72],
        [33, 12, 74],
        [34, 11, 76],
        [36, 11, 78],
        [38, 11, 81],
        [39, 11, 83],
        [41, 11, 85],
        [43, 10, 87],
        [45, 10, 89],
        [46, 10, 90],
        [48, 10, 92],
        [50, 9, 94],
        [52, 9, 95],
        [54, 9, 96],
        [55, 9, 98],
        [57, 9, 99],
        [59, 9, 100],
        [60, 9, 101],
        [62, 9, 102],
        [64, 9, 103],
        [66, 9, 104],
        [67, 10, 104],
        [69, 10, 105],
        [71, 10, 106],
        [72, 11, 106],
        [74, 11, 107],
        [76, 12, 107],
        [77, 12, 108],
        [79, 13, 108],
        [80, 13, 108],
        [82, 14, 109],
        [84, 14, 109],
        [85, 15, 109],
        [87, 15, 109],
        [89, 16, 110],
        [90, 17, 110],
        [92, 17, 110],
        [93, 18, 110],
        [95, 18, 110],
        [97, 19, 110],
        [98, 20, 110],
        [100, 20, 110],
        [101, 21, 110],
        [103, 21, 110],
        [104, 22, 110],
        [106, 23, 110],
        [108, 23, 110],
        [109, 24, 110],
        [111, 24, 110],
        [112, 25, 110],
        [114, 26, 110],
        [116, 26, 110],
        [117, 27, 110],
        [119, 27, 109],
        [120, 28, 109],
        [122, 28, 109],
        [124, 29, 109],
        [125, 29, 108],
        [127, 30, 108],
        [128, 31, 108],
        [130, 31, 108],
        [132, 32, 107],
        [133, 32, 107],
        [135, 33, 107],
        [136, 33, 106],
        [138, 34, 106],
        [140, 35, 105],
        [141, 35, 105],
        [143, 36, 104],
        [144, 36, 104],
        [146, 37, 104],
        [148, 37, 103],
        [149, 38, 103],
        [151, 39, 102],
        [152, 39, 101],
        [154, 40, 101],
        [155, 40, 100],
        [157, 41, 100],
        [159, 42, 99],
        [160, 42, 98],
        [162, 43, 98],
        [163, 43, 97],
        [165, 44, 96],
        [167, 45, 96],
        [168, 45, 95],
        [170, 46, 94],
        [171, 47, 93],
        [173, 47, 93],
        [174, 48, 92],
        [176, 49, 91],
        [177, 49, 90],
        [179, 50, 89],
        [180, 51, 89],
        [182, 52, 88],
        [183, 52, 87],
        [185, 53, 86],
        [186, 54, 85],
        [188, 55, 84],
        [189, 56, 83],
        [191, 56, 82],
        [192, 57, 81],
        [194, 58, 80],
        [195, 59, 79],
        [197, 60, 78],
        [198, 61, 77],
        [199, 62, 76],
        [201, 63, 75],
        [202, 64, 74],
        [203, 65, 73],
        [205, 66, 72],
        [206, 67, 71],
        [207, 68, 70],
        [209, 69, 69],
        [210, 70, 68],
        [211, 71, 67],
        [213, 72, 65],
        [214, 73, 64],
        [215, 74, 63],
        [216, 76, 62],
        [217, 77, 61],
        [219, 78, 60],
        [220, 79, 59],
        [221, 81, 57],
        [222, 82, 56],
        [223, 83, 55],
        [224, 85, 54],
        [225, 86, 53],
        [226, 87, 51],
        [227, 89, 50],
        [228, 90, 49],
        [229, 91, 48],
        [230, 93, 47],
        [231, 94, 45],
        [232, 96, 44],
        [233, 97, 43],
        [234, 99, 42],
        [235, 100, 40],
        [236, 102, 39],
        [237, 103, 38],
        [237, 105, 37],
        [238, 106, 35],
        [239, 108, 34],
        [240, 110, 33],
        [241, 111, 32],
        [241, 113, 30],
        [242, 114, 29],
        [243, 116, 28],
        [243, 118, 26],
        [244, 119, 25],
        [244, 121, 24],
        [245, 123, 22],
        [246, 125, 21],
        [246, 126, 20],
        [247, 128, 18],
        [247, 130, 17],
        [248, 132, 16],
        [248, 133, 14],
        [248, 135, 13],
        [249, 137, 12],
        [249, 139, 11],
        [250, 141, 9],
        [250, 142, 8],
        [250, 144, 8],
        [251, 146, 7],
        [251, 148, 6],
        [251, 150, 6],
        [251, 152, 6],
        [252, 153, 6],
        [252, 155, 6],
        [252, 157, 6],
        [252, 159, 7],
        [252, 161, 7],
        [252, 163, 8],
        [252, 165, 10],
        [252, 167, 11],
        [252, 169, 13],
        [252, 170, 14],
        [252, 172, 16],
        [252, 174, 18],
        [252, 176, 20],
        [252, 178, 22],
        [252, 180, 24],
        [252, 182, 26],
        [252, 184, 28],
        [252, 186, 30],
        [251, 188, 33],
        [251, 190, 35],
        [251, 192, 37],
        [251, 194, 40],
        [250, 196, 42],
        [250, 198, 45],
        [250, 200, 47],
        [249, 202, 50],
        [249, 204, 52],
        [249, 206, 55],
        [248, 208, 58],
        [248, 210, 61],
        [247, 212, 63],
        [247, 214, 66],
        [246, 216, 69],
        [246, 217, 73],
        [245, 219, 76],
        [245, 221, 79],
        [244, 223, 82],
        [244, 225, 86],
        [244, 227, 89],
        [243, 229, 93],
        [243, 231, 97],
        [242, 233, 101],
        [242, 234, 105],
        [242, 236, 109],
        [242, 238, 113],
        [242, 239, 117],
        [242, 241, 121],
        [242, 243, 125],
        [243, 244, 130],
        [243, 245, 134],
        [244, 247, 138],
        [245, 248, 142],
        [246, 249, 146],
        [247, 251, 150],
        [248, 252, 154],
        [249, 253, 157],
        [251, 254, 161],
        [253, 255, 165],
    ];
    let index: usize = (255. * val) as usize;
    return DATA[index];
}

/// Cividis color map
/// # Arguments
/// * `val` : Normalised value to be converted.
///
/// # Returns
/// A set of `RGB` values based on the cividis color map.
///
/// # Reference
/// [matplotlib/lib/matplotlib/_cm_listed.py](https://github.com/matplotlib/matplotlib).
pub fn cividis(val: f64) -> [u8; 3] {
    const DATA: [[u8; 3]; 256] = [
        [0, 34, 78],
        [0, 35, 79],
        [0, 36, 81],
        [0, 36, 83],
        [0, 37, 84],
        [0, 38, 86],
        [0, 39, 88],
        [0, 39, 90],
        [0, 40, 91],
        [0, 41, 93],
        [0, 41, 95],
        [0, 42, 97],
        [0, 43, 99],
        [0, 43, 101],
        [0, 44, 102],
        [0, 45, 104],
        [0, 45, 106],
        [0, 46, 108],
        [0, 47, 110],
        [0, 48, 111],
        [0, 48, 112],
        [0, 49, 113],
        [0, 49, 113],
        [0, 50, 113],
        [4, 51, 113],
        [8, 51, 113],
        [11, 52, 113],
        [15, 53, 112],
        [17, 53, 112],
        [20, 54, 112],
        [22, 55, 112],
        [24, 55, 112],
        [26, 56, 111],
        [28, 57, 111],
        [30, 58, 111],
        [31, 58, 111],
        [33, 59, 111],
        [35, 60, 111],
        [36, 60, 110],
        [38, 61, 110],
        [39, 62, 110],
        [41, 63, 110],
        [42, 63, 110],
        [43, 64, 110],
        [45, 65, 109],
        [46, 65, 109],
        [47, 66, 109],
        [48, 67, 109],
        [50, 67, 109],
        [51, 68, 109],
        [52, 69, 109],
        [53, 70, 109],
        [54, 70, 109],
        [55, 71, 109],
        [57, 72, 108],
        [58, 72, 108],
        [59, 73, 108],
        [60, 74, 108],
        [61, 74, 108],
        [62, 75, 108],
        [63, 76, 108],
        [64, 77, 108],
        [65, 77, 108],
        [66, 78, 108],
        [67, 79, 108],
        [68, 79, 108],
        [69, 80, 108],
        [70, 81, 108],
        [71, 81, 108],
        [72, 82, 108],
        [73, 83, 108],
        [74, 83, 108],
        [75, 84, 108],
        [76, 85, 108],
        [77, 86, 109],
        [78, 86, 109],
        [79, 87, 109],
        [80, 88, 109],
        [81, 88, 109],
        [82, 89, 109],
        [83, 90, 109],
        [84, 90, 109],
        [85, 91, 109],
        [86, 92, 109],
        [87, 93, 110],
        [87, 93, 110],
        [88, 94, 110],
        [89, 95, 110],
        [90, 95, 110],
        [91, 96, 110],
        [92, 97, 110],
        [93, 98, 111],
        [94, 98, 111],
        [95, 99, 111],
        [96, 100, 111],
        [96, 100, 111],
        [97, 101, 111],
        [98, 102, 112],
        [99, 102, 112],
        [100, 103, 112],
        [101, 104, 112],
        [102, 105, 113],
        [103, 105, 113],
        [104, 106, 113],
        [104, 107, 113],
        [105, 107, 113],
        [106, 108, 114],
        [107, 109, 114],
        [108, 110, 114],
        [109, 110, 115],
        [110, 111, 115],
        [110, 112, 115],
        [111, 113, 115],
        [112, 113, 116],
        [113, 114, 116],
        [114, 115, 116],
        [115, 115, 117],
        [116, 116, 117],
        [116, 117, 117],
        [117, 118, 118],
        [118, 118, 118],
        [119, 119, 119],
        [120, 120, 119],
        [121, 121, 119],
        [122, 121, 120],
        [122, 122, 120],
        [123, 123, 120],
        [124, 123, 120],
        [125, 124, 121],
        [126, 125, 121],
        [127, 126, 121],
        [128, 126, 121],
        [129, 127, 121],
        [130, 128, 121],
        [131, 129, 121],
        [132, 129, 121],
        [133, 130, 121],
        [134, 131, 121],
        [135, 132, 121],
        [135, 132, 121],
        [136, 133, 121],
        [137, 134, 121],
        [138, 135, 121],
        [139, 135, 121],
        [140, 136, 121],
        [141, 137, 121],
        [142, 138, 121],
        [143, 138, 121],
        [144, 139, 120],
        [145, 140, 120],
        [146, 141, 120],
        [147, 142, 120],
        [148, 142, 120],
        [149, 143, 120],
        [150, 144, 120],
        [151, 145, 120],
        [152, 145, 119],
        [153, 146, 119],
        [154, 147, 119],
        [155, 148, 119],
        [156, 149, 119],
        [157, 149, 118],
        [158, 150, 118],
        [159, 151, 118],
        [160, 152, 118],
        [161, 152, 118],
        [162, 153, 117],
        [163, 154, 117],
        [164, 155, 117],
        [165, 156, 117],
        [166, 156, 116],
        [167, 157, 116],
        [168, 158, 116],
        [169, 159, 116],
        [170, 160, 115],
        [171, 160, 115],
        [172, 161, 115],
        [173, 162, 114],
        [174, 163, 114],
        [175, 164, 114],
        [176, 164, 113],
        [177, 165, 113],
        [178, 166, 113],
        [179, 167, 112],
        [180, 168, 112],
        [181, 169, 111],
        [183, 169, 111],
        [184, 170, 111],
        [185, 171, 110],
        [186, 172, 110],
        [187, 173, 109],
        [188, 174, 109],
        [189, 174, 108],
        [190, 175, 108],
        [191, 176, 108],
        [192, 177, 107],
        [193, 178, 107],
        [194, 179, 106],
        [195, 179, 106],
        [196, 180, 105],
        [197, 181, 104],
        [198, 182, 104],
        [199, 183, 103],
        [200, 184, 103],
        [201, 185, 102],
        [203, 186, 102],
        [204, 186, 101],
        [205, 187, 100],
        [206, 188, 100],
        [207, 189, 99],
        [208, 190, 98],
        [209, 191, 98],
        [210, 192, 97],
        [211, 193, 96],
        [212, 193, 96],
        [213, 194, 95],
        [214, 195, 94],
        [216, 196, 93],
        [217, 197, 93],
        [218, 198, 92],
        [219, 199, 91],
        [220, 200, 90],
        [221, 201, 89],
        [222, 202, 89],
        [223, 202, 88],
        [224, 203, 87],
        [226, 204, 86],
        [227, 205, 85],
        [228, 206, 84],
        [229, 207, 83],
        [230, 208, 82],
        [231, 209, 81],
        [232, 210, 80],
        [233, 211, 79],
        [235, 212, 78],
        [236, 213, 77],
        [237, 214, 75],
        [238, 214, 74],
        [239, 215, 73],
        [240, 216, 72],
        [241, 217, 70],
        [243, 218, 69],
        [244, 219, 68],
        [245, 220, 66],
        [246, 221, 65],
        [247, 222, 63],
        [248, 223, 62],
        [250, 224, 60],
        [251, 225, 58],
        [252, 226, 56],
        [253, 227, 54],
        [255, 228, 52],
        [255, 229, 52],
        [255, 230, 53],
        [255, 232, 54],
        [255, 233, 55],
    ];
    let index: usize = (255. * val) as usize;
    return DATA[index];
}
